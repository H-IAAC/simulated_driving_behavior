# Driver Behavior Classification using SUMO and CARLA Simulations

This project uses synthetic driving data generated via **SUMO** and **CARLA** simulators to augment **UAH-DriveSet** and classify driver behavior (e.g., *aggressive*, *normal*). Multiple simulation configurations are used to augment the data and train robust machine learning models. The repository includes simulation tools, data processing pipelines, and evaluation notebooks.

---

## ğŸš¦ Project Structure

```
driver-behavior-simulation/
â”œâ”€â”€ data/ # All datasets
â”‚ â”œâ”€â”€ base/ # UAH-Driveset
â”‚ â”œâ”€â”€ synthetic/Town01 # Generated via CARLA and SUMO
â”‚ â”‚ â”œâ”€â”€ sumo # SUMO simulation data and metadata
â”‚ â”‚ â””â”€â”€ carla # CARLA simulation data and metadata
â”‚ â””â”€â”€ merged/ # Datasets combined for experiments
â”‚
â”œâ”€â”€ notebooks/ # Jupyter notebooks for all major steps
â”‚ â”œâ”€â”€ 0_generate_carla_files.ipynb # Generating files for CARLA simulation and routines
â”‚ â”œâ”€â”€ 0_generate_carla_data.ipynb # Running CARLA simulation
â”‚ â”œâ”€â”€ 1_generate_sumo_files.ipynb # Generating files for SUMO simulation
â”‚ â”œâ”€â”€ 1_generate_sumo_data.ipynb # Running SUMO simulation
â”‚ â”œâ”€â”€ 2_merge_datasets.ipynb # Merging synthetic and real datasets
â”‚ â”œâ”€â”€ 3_model_training_mlflow.ipynb # Training models with MLFlow
â”‚ â”œâ”€â”€ 3_model_training.ipynb # Training best models for evalution
â”‚ â””â”€â”€ 4_evaluation.ipynb # Models evaluation
â”‚
â”œâ”€â”€ src/ # Python modules
â”‚ â”œâ”€â”€ sim/ # Interfaces for CARLA and SUMO
â”‚ â”‚ â”œâ”€â”€ carlaDriverBehParameters.csv # All possible CARLA parameters
â”‚ â”‚ â”œâ”€â”€ sumoDriverBehParameters.csv # All possible SUMO parameters
â”‚ â”‚ â”œâ”€â”€ llm_routines # Routines generated by 0_generate_carla_files.ipynb
â”‚ â”‚ â”œâ”€â”€ sumo_utils.py
â”‚ â”‚ â”œâ”€â”€ sumo_helper.py
â”‚ â”‚ â”œâ”€â”€ sumo_simulation.py
â”‚ â”‚ â”œâ”€â”€ llama_connect.py
â”‚ â”‚ â”œâ”€â”€ sumo_utils.py
â”‚ â”‚ â””â”€â”€ carla_utils.py
â”‚ â”œâ”€â”€ data/ # Data loading and preprocessing
â”‚ â”‚ â”œâ”€â”€ loader.py
â”‚ â”‚ â””â”€â”€ preprocessor.py
â”‚ â””â”€â”€ sumo_map/Town01 # SUMO map and simulation files 
â”‚
â”œâ”€â”€ configs/ # Simulation config files
â”‚ â”œâ”€â”€ carla_fixed.json
â”‚ â”œâ”€â”€ carla_llm.json
â”‚ â”œâ”€â”€ sumo_fixed.json
â”‚ â””â”€â”€ sumo_llm.json
â”‚
â”œâ”€â”€ results/ # Experiment logs, figures, metrics
â”‚ â”œâ”€â”€ metrics/ # Dataframe for TRTS, DS and PS scores
â”‚ â””â”€â”€ figures/
â”‚
â”œâ”€â”€ requirements.txt
â”œâ”€â”€ README.md
â””â”€â”€ .gitignore
```

## ğŸ“Š Objective

Simulate and classify driving behavior using two distinct approaches:

1. **Synthetic Data Generation**
   - Generate trajectories using:
     - CARLA behavior agents with various configurations
     - SUMO vehicle models with varied acceleration, deceleration, and routing
   - Label each dataset with the intended driver behavior (e.g., *aggressive*, *normal*)

2. **Machine Learning**
   - Preprocess raw simulation logs into usable features
   - Merge synthetic datasets with real-world baselines
   - Train and evaluate multiple classifiers:
     - LSTM, CNN, Decision Tree, etc.
   - Visualize results with t-SNE, UMAP, confusion matrices

---

## ğŸ› ï¸ Installation

```bash
git clone https://github.com/yourusername/driver-behavior-simulation.git
cd driver-behavior-simulation
python -m venv venv
source venv/bin/activate  # or venv\Scripts\activate on Windows
pip install -r requirements.txt
